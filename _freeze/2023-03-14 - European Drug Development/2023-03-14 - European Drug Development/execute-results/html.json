{
  "hash": "acc1e65573be6c8b8fabe7fa67ca5883",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"European Drug Development\"\nauthor: \"Hippolyte Menou\"\nformat: html\neditor: visual\n---\n\n\n\n\n# Introduction\n\nThis analysis explores drug development and approval patterns in Europe, focusing particularly on orphan drugs - medicines developed specifically for rare diseases. The data comes from the European Medicines Agency (EMA) via Miquel Anglada Girotto on GitHub. Miquel wrote about his exploration of the data.\n\nWe used the source table of all EPARs for human and veterinary medicines, rather than Miquel's scraped data. It includes information about drug authorizations, therapeutic areas, and timelines from 1995 to 2022.\n\n# Data Preparation\n\nAfter loading necessary visualization and data manipulation libraries, we import the dataset from TidyTuesday's repository. The data originates from the European Medicines Agency's table of all EPARs (European Public Assessment Reports) for human and veterinary medicines.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# devtools::install_github(\"teunbrand/elementalist\")\n\nlibrary(scales)\nlibrary(ggridges)\nlibrary(tidyverse)\nlibrary(paletteer)\nlibrary(patchwork)\nlibrary(elementalist)  \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndrugs <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-03-14/drugs.csv')\n\ndrugs %>% \n  glimpse\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 1,988\nColumns: 28\n$ category                                    <chr> \"human\", \"human\", \"human\",…\n$ medicine_name                               <chr> \"Adcetris\", \"Nityr\", \"Ebva…\n$ therapeutic_area                            <chr> \"Lymphoma, Non-Hodgkin;  H…\n$ common_name                                 <chr> \"brentuximab vedotin\", \"ni…\n$ active_substance                            <chr> \"brentuximab vedotin\", \"ni…\n$ product_number                              <chr> \"002455\", \"004582\", \"00457…\n$ patient_safety                              <lgl> FALSE, FALSE, FALSE, FALSE…\n$ authorisation_status                        <chr> \"authorised\", \"authorised\"…\n$ atc_code                                    <chr> \"L01XC12\", \"A16AX04\", NA, …\n$ additional_monitoring                       <lgl> FALSE, FALSE, TRUE, TRUE, …\n$ generic                                     <lgl> FALSE, TRUE, FALSE, FALSE,…\n$ biosimilar                                  <lgl> FALSE, FALSE, FALSE, FALSE…\n$ conditional_approval                        <lgl> FALSE, FALSE, FALSE, FALSE…\n$ exceptional_circumstances                   <lgl> FALSE, FALSE, TRUE, FALSE,…\n$ accelerated_assessment                      <lgl> FALSE, FALSE, FALSE, FALSE…\n$ orphan_medicine                             <lgl> TRUE, FALSE, TRUE, FALSE, …\n$ marketing_authorisation_date                <date> 2012-10-25, 2018-07-26, 2…\n$ date_of_refusal_of_marketing_authorisation  <date> NA, NA, NA, NA, NA, NA, N…\n$ marketing_authorisation_holder_company_name <chr> \"Takeda Pharma A/S\", \"Cycl…\n$ pharmacotherapeutic_group                   <chr> \"Antineoplastic agents\", \"…\n$ date_of_opinion                             <date> 2012-07-19, 2018-05-31, 2…\n$ decision_date                               <date> 2022-11-17, 2023-03-10, 2…\n$ revision_number                             <dbl> 34, 4, 2, 3, 30, 24, 4, 18…\n$ condition_indication                        <chr> \"Hodgkin lymphomaAdcetris …\n$ species                                     <chr> NA, NA, NA, NA, NA, NA, NA…\n$ first_published                             <dttm> 2018-07-25 13:58:00, 2018…\n$ revision_date                               <dttm> 2023-03-13 11:52:00, 2023…\n$ url                                         <chr> \"https://www.ema.europa.eu…\n```\n\n\n:::\n:::\n\n\n\n\n# Analysis of Drug Categories\n\nLooking at the therapeutic areas for human drugs with authorized status, we can see the distribution of drug development across different medical fields. This helps us understand where pharmaceutical research and development efforts have been concentrated.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndrugs %>% \n  mutate(category==\"human\", authorisation_status==\"authorized\") %>% \n  count(therapeutic_area, sort=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 670 × 2\n   therapeutic_area                           n\n   <chr>                                  <int>\n 1 <NA>                                     285\n 2 Diabetes Mellitus, Type 2                 73\n 3 HIV Infections                            71\n 4 Hypertension                              47\n 5 Diabetes Mellitus                         37\n 6 Pulmonary Disease, Chronic Obstructive    30\n 7 Hepatitis C, Chronic                      22\n 8 Multiple Myeloma                          22\n 9 Parkinson Disease                         20\n10 Carcinoma, Non-Small-Cell Lung            19\n# ℹ 660 more rows\n```\n\n\n:::\n:::\n\n\n\n\n# Time to Market Analysis\n\nWe examine the time between opinion date and decision date for non-generic, non-biosimilar human drugs. The violin plot comparison between orphan and non-orphan medicines reveals the variation in approval timelines, highlighting potential differences in the review process for these categories.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndrugs %>% \n  mutate(time_to_market = decision_date - date_of_opinion) %>% \n  filter(category==\"human\", !generic, !biosimilar, time_to_market>0) %>% \n  ggplot(aes(x = time_to_market, y = orphan_medicine)) + \n    geom_violin()\n```\n\n::: {.cell-output-display}\n![](2023-03-14---European-Drug-Development_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n\n\n# Deep Dive into Orphan Drugs\n\nFor our main analysis, we create two complementary visualizations using Jack Bush's color palette to explore orphan drug development over time:\n\n## Temporal Analysis (1995-2022): \n\n-   Shows the yearly number of drug evaluations by the EMA\n-   Highlights the impact of EU orphan regulation (effective 2000)\n-   Demonstrates the relatively slow initial uptake of orphan drug submissions\n-   Notes the recent trend, with only 20 orphan drugs submitted in 2022\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\njack_bush_palette <- paletteer_d(\"lisa::JackBush_1\")\nnames(jack_bush_palette) <- c(\"Drug authorised\", \"Drug withdrawn\", \"Orphan drug authorised\", \"Orphan drug withdrawn\")\njack_bush_palette\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<colors>\n#A1D8B6FF #D2C48EFF #F45F40FF #F9AE8DFF #80B9CEFF \n```\n\n\n:::\n\n```{.r .cell-code}\ntheme_set(theme_minimal())\ntheme_update(\n  # Legend Styling\n  legend.title = element_blank(), \n  legend.position = \"none\", \n  \n  # Title Styling\n  plot.title = element_text(hjust = 0.5, face = \"bold\", size = 16),\n  plot.subtitle = element_text(hjust = 0.5),\n  \n  \n  #\n  panel.grid.minor = element_blank(),\n  \n  # Margins\n  plot.margin = margin(t = 20, r = 20, b = 20, l = 20),\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\norphan_drugs_years <- drugs %>% \n  mutate(year = year(date_of_opinion)) %>%  # date_of_opinion, decision_date, first_published, marketing_authorisation_date, revision_date\n  filter(!is.na(year)) %>% \n  group_by(orphan_medicine, authorisation_status) %>% \n  count(year) %>% \n  mutate(authorisation_status = if_else(authorisation_status==\"authorised\", T, F),\n         approved_orphan = case_when(\n           orphan_medicine & authorisation_status ~ \"Orphan drug authorised\",  # TRUE/TRUE\n           orphan_medicine & !authorisation_status ~ \"Orphan drug withdrawn\",  # TRUE/FALSE\n           !orphan_medicine & authorisation_status ~ \"Drug authorised\",   # FALSE/TRUE\n           !orphan_medicine & !authorisation_status ~ \"Drug withdrawn\"   # FALSE/FALSE\n         ) %>% factor(levels=c(\"Drug withdrawn\", \"Drug authorised\", \"Orphan drug withdrawn\", \"Orphan drug authorised\")))  \n\norphan_drugs_years\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 82 × 5\n# Groups:   orphan_medicine, authorisation_status [4]\n   orphan_medicine authorisation_status  year     n approved_orphan\n   <lgl>           <lgl>                <dbl> <int> <fct>          \n 1 FALSE           TRUE                  1995     4 Drug authorised\n 2 FALSE           TRUE                  1996     7 Drug authorised\n 3 FALSE           TRUE                  1997     5 Drug authorised\n 4 FALSE           TRUE                  1998    15 Drug authorised\n 5 FALSE           TRUE                  1999    13 Drug authorised\n 6 FALSE           TRUE                  2000    17 Drug authorised\n 7 FALSE           TRUE                  2001     7 Drug authorised\n 8 FALSE           TRUE                  2002    13 Drug authorised\n 9 FALSE           TRUE                  2003     8 Drug authorised\n10 FALSE           TRUE                  2004    16 Drug authorised\n# ℹ 72 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\norphan_years_plot <- orphan_drugs_years %>% \n  ggplot(aes(x=year, y=n, fill=approved_orphan)) + \n  geom_col() + \n  \n  scale_fill_manual(values=jack_bush_palette, breaks=c(\"Drug authorised\", \"Drug withdrawn\", \"Orphan drug authorised\", \"Orphan drug withdrawn\")) + \n  \n  scale_x_continuous(breaks=seq(1995, 2020, 5)) +\n  scale_y_continuous(breaks=seq(0, 120, 20)) +\n\n  # Number below horizon\n  geom_text(data = orphan_drugs_years %>% filter(approved_orphan == \"Orphan drug authorised\"), aes(label=n), colour=\"#F45F40FF\", y = -2, fontface=\"bold\") +\n  \n  labs(x = \"Year of Opinion\",\n       y = \"Number of Drugs\", \n       title = \"Number of drugs evaluated by the \\n European Medicines Agency each year\",\n       subtitle = \"Submissions for orphan designation lagged after the EU orphan regulation became \\neffective in 2000. In 2022, only 20 orphan drugs were submitted for evaluation.\",\n       # caption = \"Data source: European Medicines Agency\",\n  ) +\n  \n  theme(\n    # Legend Styling\n    legend.position = \"bottom\", \n    legend.box.background = element_rect_round(fill = \"white\", colour = \"black\"),\n  )\n\norphan_years_plot\n```\n\n::: {.cell-output-display}\n![](2023-03-14---European-Drug-Development_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n##  Overall Statistics: \n\n-   Orphan drugs represent 12% of all approved drugs\n-   Both orphan and regular drugs maintain similar authorization rates of around 90%\n-   Provides a clear comparison of total volumes between regular and orphan drugs\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\norphan_drugs_summary <- orphan_drugs_years %>% \n  group_by(orphan_medicine, approved_orphan) %>% \n  summarise(total = sum(n)) %>% \n  ungroup %>% group_by(orphan_medicine) %>% add_tally(total) %>% ungroup %>% \n  mutate(perc = round(total / n, 2), perc2 = round(n / sum(total), 2))\n\norphan_drugs_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 6\n  orphan_medicine approved_orphan        total     n  perc perc2\n  <lgl>           <fct>                  <int> <int> <dbl> <dbl>\n1 FALSE           Drug withdrawn           105  1063   0.1  0.88\n2 FALSE           Drug authorised          958  1063   0.9  0.88\n3 TRUE            Orphan drug withdrawn     15   146   0.1  0.12\n4 TRUE            Orphan drug authorised   131   146   0.9  0.12\n```\n\n\n:::\n\n```{.r .cell-code}\norphan_total_plot <- orphan_drugs_summary %>% \n  ggplot(aes(x = orphan_medicine, y = total, fill = approved_orphan)) + \n  geom_col() + \n  \n  # Number below the horizon\n  geom_text(data = orphan_drugs_summary %>% filter(approved_orphan %in% c(\"Orphan drug authorised\", \"Drug authorised\")), aes(label=n), y=-20, fontface=\"bold\", colour=\"black\") + \n  \n  # Percentage of approval\n  geom_text(data = orphan_drugs_summary %>% filter(approved_orphan %in% c(\"Orphan drug authorised\", \"Drug authorised\")), aes(label=percent(perc)), position = position_stack(vjust = .5), colour=\"darkgray\", fontface=\"bold\") + \n  \n  # Percentage of orphan drugs total\n  geom_text(data = orphan_drugs_summary %>% filter(approved_orphan %in% c(\"Orphan drug authorised\", \"Drug authorised\")), aes(label=percent(perc2)), y=1100, fontface=\"bold\", size=6) + \n  \n  scale_fill_manual(values=jack_bush_palette, breaks=c(\"Drug authorised\", \"Drug withdrawn\", \"Orphan drug authorised\", \"Orphan drug withdrawn\")) +\n  scale_x_discrete(labels = c(\"FALSE\" = \"Drugs\", \"TRUE\" = \"Orphan drugs\")) +  # rename orphan drugs T/F\n  scale_y_continuous(breaks = seq(0, 1200, 200), expand = expansion(mult = c(0.05, 0.15))) +\n  \n  \n  labs(x = \"\",\n       y = \"Number of Drugs\", \n       title = \"Total Number of drugs evaluated by the \\n European Medicines Agency (1995-2022)\",\n       subtitle = \"Orphan drugs are 12% of drugs approved while authorisation \\n rates are around 90% for orphan drugs and regular drugs.\",\n       # caption = \"Data source: European Medicines Agency\"\n  ) +\n  \n  theme(\n    axis.title.x = element_blank()\n  )\n\norphan_total_plot\n```\n\n::: {.cell-output-display}\n![](2023-03-14---European-Drug-Development_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n## Orphan Drugs plot\n\nThe combined visualization effectively tells the story of orphan drug development in Europe, from policy implementation to current trends, while maintaining perspective on their proportion within overall drug development.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nOrphan_drugs_plot <- wrap_plots(orphan_years_plot, orphan_total_plot, ncol = 2, nrow = 1, widths = c(1, 0.33)) + \n  plot_annotation(title = 'Orphan drugs submitted for evaluation by the European Medicines Agency',\n                  subtitle = \"\",\n                  caption = \"Data source: European Medicines Agency\",\n                  \n                  # tag_levels = 'A', tag_prefix = \"Plot \",\n                  theme = theme(plot.title = element_text(size = 32)))\n\nOrphan_drugs_plot\n```\n\n::: {.cell-output-display}\n![](2023-03-14---European-Drug-Development_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"Orphan drugs plot.png\", Orphan_drugs_plot, path=\"Plots\", width = 5400, height = 3000, units = \"px\", bg=\"white\")\n```\n:::\n",
    "supporting": [
      "2023-03-14---European-Drug-Development_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}